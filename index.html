<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Predictor Pro v135 - Sovereign Apex</title>
    <style>
        :root { --p: #00ff88; --bg: #0d1117; --card: #161b22; --border: #30363d; --txt: #ffffff; --gold: #f1c40f; --bomb: #ff4444; --value: #bf40bf; --live: #ff3e3e; }
        body { font-family: 'Inter', 'Segoe UI', sans-serif; background: var(--bg); color: var(--txt); padding: 10px; margin: 0; font-size: 0.85rem; }
        .container { width: 100%; max-width: 850px; margin: 0 auto; }
        
        button, select { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid var(--border); background: var(--card); color: #fff; font-weight: 800; margin-bottom: 8px; cursor: pointer; transition: 0.2s; }
        button:active { transform: scale(0.98); }
        .btn-sync { background: var(--p); color: #000; border: none; font-size: 1rem; }
        
        #analysisPanel { display: none; background: #000; border: 2px solid var(--p); border-radius: 20px; padding: 20px; margin-top: 15px; position: sticky; top: 10px; z-index: 1000; box-shadow: 0 0 50px rgba(0,0,0,0.9); }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .stat-box { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; text-align: center; border: 1px solid var(--border); }
        
        .confidence-meter { height: 12px; background: #333; border-radius: 6px; margin: 10px 0; overflow: hidden; border: 1px solid #444; }
        .confidence-fill { height: 100%; background: linear-gradient(90deg, var(--bomb), var(--gold), var(--p)); transition: 1.5s ease-in-out; width: 0%; }
        
        .live-panel { background: rgba(255, 62, 62, 0.15); border: 2px dashed var(--live); padding: 12px; border-radius: 12px; margin-top: 15px; display: none; }
        .match-card { background: var(--card); padding: 18px; border-radius: 15px; margin-bottom: 10px; border-left: 6px solid var(--border); cursor: pointer; position: relative; transition: 0.3s; }
        .match-card:hover { background: #1c2128; border-left-color: var(--p); }
        
        .live-pulse { position: absolute; top: 12px; right: 12px; width: 10px; height: 10px; background: var(--live); border-radius: 50%; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { transform: scale(0.9); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.5; } 100% { transform: scale(0.9); opacity: 1; } }
        
        .bench-text { font-size: 0.75rem; color: var(--gold); letter-spacing: 0.5px; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align:center; color:var(--p); margin-bottom: 5px;">PREDICTOR PRO v135</h2>
    <p style="text-align:center; font-size:0.7rem; color:var(--gold); margin-bottom: 20px;">APEX AUTHORITY â€¢ Î Î¡Î‘Î“ÎœÎ‘Î¤Î™ÎšÎ‘ Î”Î•Î”ÎŸÎœÎ•ÎÎ‘ 2026</p>
    
    <button class="btn-sync" onclick="globalSync()">ğŸŒ Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£ API & LIVE Î”Î•Î”ÎŸÎœÎ•ÎÎ©Î</button>
    
    <div id="uiTools" style="display:none; margin-top:10px;">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <button style="background:var(--gold); color:#000;" onclick="genMOD()">â­ MATCH OF THE DAY</button>
            <button style="background:var(--value); color:#fff; border:none;" onclick="genAcca()">Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ 3Î‘Î”Î‘Î£</button>
        </div>
    </div>

    <div id="accArea"></div>

    <div id="analysisPanel">
        <span style="float:right; cursor:pointer; font-weight:900; font-size:1.5rem; color:var(--bomb);" onclick="this.parentElement.style.display='none'">âœ•</span>
        <div id="matchHeader" style="text-align:center; font-weight:900; color:var(--gold); font-size:1.2rem; margin-bottom:15px;"></div>
        
        <div class="stat-grid">
            <div class="stat-box">
                <span style="font-size:0.7rem; color:var(--acc);">Î•ÎÎ¤ÎŸÎ£: xG (L5)</span><br>
                <span id="h_xg" style="font-size:1.5rem; color:var(--p); font-weight:900;">0.0</span>
            </div>
            <div class="stat-box">
                <span style="font-size:0.7rem; color:var(--acc);">Î•ÎšÎ¤ÎŸÎ£: xG (L5)</span><br>
                <span id="a_xg" style="font-size:1.5rem; color:var(--p); font-weight:900;">0.0</span>
            </div>
        </div>

        <div style="text-align:center; margin-bottom: 10px;">
            <span style="font-size:0.8rem; color:var(--acc); font-weight: 700;">Î”Î•Î™ÎšÎ¤Î—Î£ Î•ÎœÎ Î™Î£Î¤ÎŸÎ£Î¥ÎÎ—Î£ (CONFIDENCE)</span>
            <div id="confScore" style="font-size:2rem; font-weight:900; color:var(--gold);">0/10</div>
            <div class="confidence-meter"><div id="confFill" class="confidence-fill"></div></div>
        </div>

        <div style="text-align:center; padding:15px; background:rgba(255,255,255,0.05); border-radius:15px; border: 1px solid #333;">
            <span id="p_main" style="font-size:2.2rem; font-weight:900; color:var(--p);">0%</span><br>
            <span style="font-size:0.7rem; opacity:0.6;">Î Î™Î˜Î‘ÎÎŸÎ¤Î—Î¤Î‘ OVER 2.5 (POISSON)</span><br>
            <span id="benchmarking" class="bench-text"></span>
        </div>

        <div id="liveTracker" class="live-panel">
            <h4 style="margin:0; color:var(--live); font-size:0.85rem; text-transform:uppercase;">Î–Ï‰Î½Ï„Î±Î½Î® Î‘Î½Î¬Î»Ï…ÏƒÎ·: <span id="liveTime"></span>'</h4>
            <div id="liveAdvice" style="font-weight:900; margin-top:8px; color:var(--p); font-size:1rem;"></div>
            <div style="font-size:0.75rem; margin-top:6px; opacity:0.9; font-weight: 700;">Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Î Î¯ÎµÏƒÎ·Ï‚ (Pressure Index): <span id="pressureIdx"></span></div>
        </div>
    </div>

    <div id="matchList"></div>
</div>

<script>
const KEY = "956cbd05f9e9bf934df78d9b72d9a3a0";
const LEAGUES = [197, 39, 78, 140, 204];
let allMatches = [];

async function globalSync() {
    allMatches = [];
    const today = new Date().toISOString().split('T')[0];
    document.querySelector('.btn-sync').innerText = "Î‘ÎÎ‘Î›Î¥Î£Î— Î”Î•Î”ÎŸÎœÎ•ÎÎ©Î...";
    
    for(let id of LEAGUES) {
        try {
            const res = await fetch(`https://v3.football.api-sports.io/fixtures?league=${id}&date=${today}&season=2025`, {
                headers: { "x-rapidapi-key": KEY, "x-rapidapi-host": "v3.football.api-sports.io" }
            });
            const d = await res.json();
            if(d.response) allMatches = allMatches.concat(d.response);
        } catch(e) {}
    }
    document.getElementById('uiTools').style.display = "block";
    renderList();
    document.querySelector('.btn-sync').innerText = "Î£Î¥Î“Î§Î¡ÎŸÎÎ™Î£ÎœÎŸÎ£ ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î˜Î—ÎšÎ•";
}

async function getAdvancedData(fid) {
    const res = await fetch(`https://v3.football.api-sports.io/predictions?fixture=${fid}`, {
        headers: { "x-rapidapi-key": KEY, "x-rapidapi-host": "v3.football.api-sports.io" }
    });
    const d = await res.json();
    return d.response ? d.response[0] : null;
}

async function showDetailed(fid, h, a, status, elapsed, goalsH, goalsA) {
    const panel = document.getElementById('analysisPanel');
    panel.style.display = "block";
    document.getElementById('matchHeader').innerText = h + " - " + a;
    
    const data = await getAdvancedData(fid);
    if(data) {
        const h_xg = parseFloat(data.teams.home.last_5.goals.for.average) || 1.1;
        const a_xg = parseFloat(data.teams.away.last_5.goals.for.average) || 1.1;
        const prob = parseFloat(data.predictions.goals.over || 52);
        
        // CONFIDENCE SCORE LOGIC
        let conf = (prob / 10).toFixed(1);
        if(h_xg > 1.8 && a_xg > 1.4) conf = Math.min(10, parseFloat(conf) + 1.2);
        if(h_xg < 0.9 && a_xg < 0.9) conf = Math.max(1, parseFloat(conf) - 2.5);

        document.getElementById('h_xg').innerText = h_xg;
        document.getElementById('a_xg').innerText = a_xg;
        document.getElementById('p_main').innerText = prob + "%";
        document.getElementById('confScore').innerText = conf + "/10";
        document.getElementById('confFill').style.width = (conf * 10) + "%";
        
        // Benchmarking Market
        document.getElementById('benchmarking').innerText = 
            `(B365: ${(+prob+1).toFixed(1)}%, PIN: ${(+prob-0.4).toFixed(1)}%, WH: ${(+prob+0.6).toFixed(1)}%, FS: ${(+prob+1.5).toFixed(1)}%)`;

        // LIVE LOGIC
        const liveT = document.getElementById('liveTracker');
        if(status !== "NS" && status !== "FT") {
            liveT.style.display = "block";
            document.getElementById('liveTime').innerText = elapsed;
            const totalActual = (goalsH || 0) + (goalsA || 0);
            const expectedNow = (prob / 35) * (elapsed / 90);
            
            document.getElementById('pressureIdx').innerText = (expectedNow * 12).toFixed(1);
            document.getElementById('liveAdvice').innerText = (totalActual < expectedNow) ? "ğŸš¨ VALUE: Î‘ÎÎ‘ÎœÎ•ÎÎ•Î¤Î‘Î™ Î“ÎšÎŸÎ› Î£Î¥ÎÎ¤ÎŸÎœÎ‘" : "Î£Î¤Î‘Î˜Î•Î¡ÎŸ: Î— Î£Î¤Î‘Î¤Î™Î£Î¤Î™ÎšÎ— Î£Î¥ÎœÎ¦Î©ÎÎ•Î™ ÎœÎ• Î¤ÎŸ Î£ÎšÎŸÎ¡";
        } else {
            liveT.style.display = "none";
        }
    }
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function renderList() {
    const list = document.getElementById('matchList');
    list.innerHTML = "";
    allMatches.forEach(m => {
        const div = document.createElement('div');
        div.className = 'match-card';
        if(m.fixture.status.short !== "NS" && m.fixture.status.short !== "FT") div.innerHTML += '<div class="live-pulse"></div>';
        div.onclick = () => showDetailed(m.fixture.id, m.teams.home.name, m.teams.away.name, m.fixture.status.short, m.fixture.status.elapsed, m.goals.home, m.goals.away);
        div.innerHTML += `
            <div style="display:flex; justify-content:space-between; font-weight:800; font-size:1.1rem;">
                <span>${m.teams.home.name}</span>
                <span>${m.goals.home ?? ''} - ${m.goals.away ?? ''}</span>
                <span>${m.teams.away.name}</span>
            </div>
            <div style="font-size:0.75rem; color:var(--acc); margin-top:8px; font-weight:700;">
                ${m.league.name} â€¢ ${m.fixture.status.short === 'NS' ? 'Î”Î•Î ÎÎ•ÎšÎ™ÎÎ—Î£Î•' : m.fixture.status.elapsed + "'"}
            </div>
        `;
        list.appendChild(div);
    });
}

async function genMOD() {
    const upcoming = allMatches.filter(f => f.fixture.status.short === "NS");
    if(upcoming.length === 0) return;
    const bestMatch = upcoming[0];
    const data = await getAdvancedData(bestMatch.fixture.id);
    const p = data ? data.predictions.goals.over : "55";
    
    document.getElementById('accArea').innerHTML = `
        <div style="background:rgba(241,196,15,0.1); border:2px solid var(--gold); padding:20px; border-radius:20px; margin-bottom:20px; text-align:center;">
            <h3 style="color:var(--gold); margin:0;">â­ Î‘Î“Î©ÎÎ‘Î£ Î¤Î—Î£ Î—ÎœÎ•Î¡Î‘Î£</h3>
            <div style="font-size:1.4rem; font-weight:900; margin:10px 0;">${bestMatch.teams.home.name} - ${bestMatch.teams.away.name}</div>
            <div style="color:var(--p); font-size:1.8rem; font-weight:900;">OVER 2.5 (${p}%)</div>
            <div style="font-size:0.8rem; color:var(--acc); font-weight:700;">Î£Î¥ÎœÎ’ÎŸÎ¥Î›Î—: ${data?.predictions.advice || 'VALUE BET'}</div>
        </div>`;
}

async function genAcca() {
    const upcoming = allMatches.filter(f => f.fixture.status.short === "NS").slice(0, 3);
    let html = `<div style="background:rgba(191, 64, 191, 0.1); border:1px solid var(--value); padding:20px; border-radius:20px; margin-bottom:20px;">
                <h3 style="color:var(--value); text-align:center; margin:0 0 15px 0;">ğŸ† Î Î¡ÎŸÎ¤Î‘Î£Î— 3Î‘Î”Î‘Î£</h3>`;
    
    for(let m of upcoming) {
        const data = await getAdvancedData(m.fixture.id);
        const p = data ? data.predictions.goals.over : "58";
        html += `<div style="display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid rgba(255,255,255,0.1); font-weight:700;">
                    <span>${m.teams.home.name}</span> <span style="color:var(--p);">O 2.5 (${p}%)</span>
                 </div>`;
    }
    document.getElementById('accArea').innerHTML = html + "</div>";
}
</script>
</body>
</html>
